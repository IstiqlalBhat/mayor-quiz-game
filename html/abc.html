<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mane Street Mayor - Interactive City Builder</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Fredoka', 'Comic Sans MS', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Particle Background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            opacity: 0.3;
            animation: float 20s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            50% { transform: translateY(-100px) translateX(50px); }
        }

        .game-wrapper {
            position: relative;
            z-index: 1;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Header with animated title */
        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            border-radius: 20px 20px 0 0;
            text-align: center;
            color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.1); opacity: 0.6; }
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
            position: relative;
            z-index: 1;
            animation: titleBounce 2s ease-in-out infinite;
        }

        @keyframes titleBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .header p {
            font-size: 1.3em;
            font-style: italic;
            position: relative;
            z-index: 1;
        }

        /* Timer Styles */
        .timer-container {
            position: relative;
            z-index: 1;
            margin-top: 20px;
            display: none; /* Hidden by default */
        }

        .timer-container.active {
            display: block;
        }

        .timer-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 50px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            max-width: 300px;
            margin: 0 auto;
        }

        .timer-icon {
            font-size: 2em;
            animation: timerPulse 1s ease-in-out infinite;
        }

        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        .timer-seconds {
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            min-width: 70px;
            text-align: center;
        }

        .timer-label {
            font-size: 1em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timer-bar-container {
            width: 100%;
            max-width: 400px;
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 10px auto 0;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .timer-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #55efc4);
            border-radius: 10px;
            transition: width 1s linear, background 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 184, 148, 0.5);
        }

        .timer-bar-fill.warning {
            background: linear-gradient(90deg, #fdcb6e, #e17055);
            box-shadow: 0 0 10px rgba(253, 203, 110, 0.5);
        }

        .timer-bar-fill.danger {
            background: linear-gradient(90deg, #ff7675, #d63031);
            box-shadow: 0 0 10px rgba(255, 118, 117, 0.5);
            animation: dangerPulse 0.5s ease-in-out infinite;
        }

        @keyframes dangerPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Game Container */
        .game-container {
            background: white;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            overflow: hidden;
        }

        /* City View Area */
        .city-view {
            background: linear-gradient(180deg, #87ceeb 0%, #e0f6ff 50%, #90ee90 100%);
            padding: 40px 20px;
            min-height: 300px;
            position: relative;
            overflow: hidden;
            border-bottom: 4px solid #6b8e23;
        }

        /* Clouds */
        .cloud {
            position: absolute;
            background: white;
            border-radius: 100px;
            opacity: 0.8;
            animation: cloudFloat 30s linear infinite;
        }

        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: white;
            border-radius: 100px;
        }

        .cloud-1 { width: 100px; height: 40px; top: 20px; left: -100px; animation-duration: 25s; }
        .cloud-1::before { width: 50px; height: 50px; top: -20px; left: 10px; }
        .cloud-1::after { width: 60px; height: 40px; top: -10px; right: 10px; }

        .cloud-2 { width: 80px; height: 35px; top: 60px; left: -80px; animation-duration: 35s; animation-delay: -10s; }
        .cloud-2::before { width: 40px; height: 40px; top: -15px; left: 10px; }
        .cloud-2::after { width: 50px; height: 35px; top: -8px; right: 10px; }

        @keyframes cloudFloat {
            from { transform: translateX(0); }
            to { transform: translateX(calc(100vw + 200px)); }
        }

        /* Sun */
        .sun {
            position: absolute;
            top: 30px;
            right: 50px;
            width: 60px;
            height: 60px;
            background: #ffdb4d;
            border-radius: 50%;
            box-shadow: 0 0 30px #ffdb4d;
            animation: sunPulse 3s ease-in-out infinite;
        }

        @keyframes sunPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px #ffdb4d; }
            50% { transform: scale(1.1); box-shadow: 0 0 50px #ffdb4d; }
        }

        /* Buildings Container */
        .buildings {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 10px;
            position: relative;
            z-index: 2;
            margin-top: 100px;
        }

        /* Building Styles */
        .building {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
            animation: buildingAppear 0.5s ease-out;
        }

        .building:hover {
            transform: translateY(-10px);
        }

        @keyframes buildingAppear {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .building-body {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            border: 3px solid #2c3e50;
            border-radius: 5px 5px 0 0;
            position: relative;
        }

        .building.factory .building-body {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        .building.park .building-body {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .building.house .building-body {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
        }

        .window {
            background: #f39c12;
            border: 2px solid #2c3e50;
            display: inline-block;
            margin: 5px;
            animation: windowBlink 3s infinite;
        }

        @keyframes windowBlink {
            0%, 90%, 100% { opacity: 1; }
            95% { opacity: 0.3; }
        }

        .roof {
            width: 0;
            height: 0;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 30px solid #e74c3c;
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
        }

        /* Stats Panel */
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            padding: 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .stat {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .stat:hover::before {
            left: 100%;
        }

        .stat-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: block;
            animation: iconBounce 2s ease-in-out infinite;
        }

        @keyframes iconBounce {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-5deg); }
        }

        .stat-label {
            font-size: 0.95em;
            color: #666;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .stat-bar {
            height: 12px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .stat-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .happiness-bar { background: linear-gradient(90deg, #ff6b6b, #4ecdc4); }
        .funds-bar { background: linear-gradient(90deg, #ffd93d, #6bcf7f); }
        .interest-bar { background: linear-gradient(90deg, #a8e6cf, #ff8b94); }

        /* Content Area */
        .game-content {
            padding: 40px;
            max-height: 500px;
            overflow-y: auto;
            background: white;
        }

        .game-content::-webkit-scrollbar {
            width: 10px;
        }

        .game-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .game-content::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        /* Story Section */
        .story-section {
            background: linear-gradient(135deg, #fff9e6 0%, #fff5cc 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 6px solid #ffd93d;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .story-section h2 {
            color: #d63031;
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .story-text {
            line-height: 1.8;
            color: #333;
            font-size: 1.1em;
        }

        .story-text p {
            margin-bottom: 15px;
        }

        /* Choice Cards */
        .choices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .choice-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 25px;
            border-radius: 15px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .choice-card::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .choice-card:hover::before {
            width: 300px;
            height: 300px;
        }

        .choice-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .choice-card:active {
            transform: translateY(-4px) scale(0.98);
        }

        .choice-icon {
            font-size: 2.5em;
            display: block;
            margin-bottom: 10px;
        }

        .choice-text {
            position: relative;
            z-index: 1;
            font-weight: 600;
        }

        /* Consequence Notification */
        .consequences {
            background: linear-gradient(135deg, #ffe5e5 0%, #ffd5d5 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 6px solid #ff6b6b;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .consequences h3 {
            color: #d63031;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .consequence-item {
            margin: 10px 0;
            padding: 10px;
            display: flex;
            align-items: center;
            font-size: 1.1em;
            font-weight: 600;
            animation: popIn 0.3s ease-out;
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .consequence-item.positive {
            color: #00b894;
        }

        .consequence-item.negative {
            color: #d63031;
        }

        /* Chapter Title */
        .chapter-title {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.6em;
            box-shadow: 0 5px 20px rgba(240, 147, 251, 0.4);
            animation: slideInDown 0.5s ease-out;
        }

        @keyframes slideInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Start Button */
        .start-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            padding: 25px 60px;
            border-radius: 50px;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.5);
            position: relative;
            overflow: hidden;
        }

        .start-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .start-btn:hover::before {
            width: 400px;
            height: 400px;
        }

        .start-btn:hover {
            transform: scale(1.08);
            box-shadow: 0 15px 40px rgba(240, 147, 251, 0.7);
        }

        .start-btn:active {
            transform: scale(0.95);
        }

        .start-btn-text {
            position: relative;
            z-index: 1;
        }

        .intro-screen {
            text-align: center;
            padding: 30px 0;
        }

        /* Game Over Screen */
        .game-over {
            text-align: center;
            padding: 30px;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .game-over h2 {
            font-size: 3em;
            margin-bottom: 20px;
            animation: zoomIn 0.5s ease-out;
        }

        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .final-stats {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .final-stats h3 {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #333;
        }

        .final-stat-item {
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 10px;
            font-size: 1.2em;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            animation: slideInLeft 0.5s ease-out;
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9em;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 40px;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .buildings { flex-wrap: wrap; }
            .stats-panel { grid-template-columns: 1fr; }
            .choices { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Particle Background -->
    <div class="particles" id="particles"></div>

    <div class="game-wrapper">
        <div class="game-container">
            <!-- Header -->
            <div class="header">
                <h1>üèõÔ∏è Mane Street Mayor üèõÔ∏è</h1>
                <p>Politics? More like Paw-litics!</p>
                
                <!-- Timer Display -->
                <div class="timer-container" id="timer-container">
                    <div class="timer-display">
                        <span class="timer-icon">‚è∞</span>
                        <span class="timer-seconds" id="timer-seconds">60</span>
                        <span class="timer-label">seconds</span>
                    </div>
                    <div class="timer-bar-container">
                        <div class="timer-bar-fill" id="timer-bar-fill"></div>
                    </div>
                </div>
            </div>

            <!-- City View -->
            <div class="city-view" id="city-view">
                <div class="sun"></div>
                <div class="cloud cloud-1"></div>
                <div class="cloud cloud-2"></div>
                <div class="buildings" id="buildings">
                    <!-- Buildings will be added dynamically -->
                </div>
            </div>

            <!-- Stats Panel -->
            <div class="stats-panel">
                <div class="stat" data-tooltip="How happy are your citizens?">
                    <span class="stat-icon">üòä</span>
                    <div class="stat-label">Population Happiness</div>
                    <div class="stat-value" id="happiness-value">50</div>
                    <div class="stat-bar">
                        <div class="stat-bar-fill happiness-bar" id="happiness-bar" style="width: 50%"></div>
                    </div>
                </div>
                <div class="stat" data-tooltip="Money available for city projects">
                    <span class="stat-icon">üí∞</span>
                    <div class="stat-label">City Funds</div>
                    <div class="stat-value" id="funds-value">$50M</div>
                    <div class="stat-bar">
                        <div class="stat-bar-fill funds-bar" id="funds-bar" style="width: 50%"></div>
                    </div>
                </div>
                <div class="stat" data-tooltip="Support from businesses and organizations">
                    <span class="stat-icon">üèõÔ∏è</span>
                    <div class="stat-label">Special Interest Support</div>
                    <div class="stat-value" id="interest-value">50</div>
                    <div class="stat-bar">
                        <div class="stat-bar-fill interest-bar" id="interest-bar" style="width: 50%"></div>
                    </div>
                </div>
                <div class="stat" data-tooltip="Your personal wealth (watch out for corruption!)">
                    <span class="stat-icon">üíµ</span>
                    <div class="stat-label">Your Profit</div>
                    <div class="stat-value" id="profit-value">$0</div>
                </div>
            </div>

            <!-- Game Content -->
            <div class="game-content" id="game-content">
                <!-- Content will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Tooltip Element -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        // Create particle background
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // Tooltip functionality
        document.querySelectorAll('[data-tooltip]').forEach(element => {
            element.addEventListener('mouseenter', (e) => {
                const tooltip = document.getElementById('tooltip');
                tooltip.textContent = e.target.getAttribute('data-tooltip');
                tooltip.style.opacity = '1';
            });
            
            element.addEventListener('mousemove', (e) => {
                const tooltip = document.getElementById('tooltip');
                tooltip.style.left = e.pageX + 15 + 'px';
                tooltip.style.top = e.pageY + 15 + 'px';
            });
            
            element.addEventListener('mouseleave', () => {
                const tooltip = document.getElementById('tooltip');
                tooltip.style.opacity = '0';
            });
        });

        // Game State
        const gameState = {
            happiness: 50,
            cityFunds: 50,
            specialInterest: 50,
            personalProfit: 0,
            decisions: [],
            buildings: ['city-hall', 'house', 'house'],
            timerSeconds: 60,
            isTimerRunning: false,
            timerInterval: null
        };

        // Building types and their properties
        const buildingTypes = {
            'city-hall': { width: 120, height: 140, windows: 12, color: '#3498db', icon: 'üèõÔ∏è' },
            'house': { width: 80, height: 100, windows: 6, color: '#e67e22', icon: 'üè†' },
            'factory': { width: 150, height: 120, windows: 16, color: '#95a5a6', icon: 'üè≠' },
            'park': { width: 100, height: 80, windows: 0, color: '#2ecc71', icon: 'üå≥' },
            'office': { width: 90, height: 130, windows: 12, color: '#9b59b6', icon: 'üè¢' },
            'shop': { width: 70, height: 90, windows: 4, color: '#e74c3c', icon: 'üè™' }
        };

        // Add a building to the city
        function addBuilding(type) {
            gameState.buildings.push(type);
            renderBuildings();
        }

        // Render buildings in the city view
        function renderBuildings() {
            const container = document.getElementById('buildings');
            container.innerHTML = '';
            
            gameState.buildings.forEach((type, index) => {
                const props = buildingTypes[type];
                const building = document.createElement('div');
                building.className = 'building ' + type;
                building.style.animationDelay = (index * 0.1) + 's';
                building.setAttribute('data-tooltip', props.icon + ' ' + type.replace('-', ' ').toUpperCase());
                
                const body = document.createElement('div');
                body.className = 'building-body';
                body.style.width = props.width + 'px';
                body.style.height = props.height + 'px';
                
                // Add windows
                if (props.windows > 0) {
                    const rows = Math.ceil(Math.sqrt(props.windows));
                    const cols = Math.ceil(props.windows / rows);
                    const windowSize = Math.min(
                        (props.width - 20) / cols - 10,
                        (props.height - 20) / rows - 10
                    );
                    
                    for (let i = 0; i < props.windows; i++) {
                        const window = document.createElement('div');
                        window.className = 'window';
                        window.style.width = windowSize + 'px';
                        window.style.height = windowSize + 'px';
                        window.style.animationDelay = (Math.random() * 3) + 's';
                        body.appendChild(window);
                    }
                }
                
                // Add roof for houses
                if (type === 'house' || type === 'city-hall') {
                    const roof = document.createElement('div');
                    roof.className = 'roof';
                    body.appendChild(roof);
                }
                
                building.appendChild(body);
                container.appendChild(building);
                
                // Add tooltip functionality
                building.addEventListener('mouseenter', (e) => {
                    const tooltip = document.getElementById('tooltip');
                    tooltip.textContent = props.icon + ' ' + type.replace('-', ' ').toUpperCase();
                    tooltip.style.opacity = '1';
                });
                
                building.addEventListener('mousemove', (e) => {
                    const tooltip = document.getElementById('tooltip');
                    tooltip.style.left = e.pageX + 15 + 'px';
                    tooltip.style.top = e.pageY + 15 + 'px';
                });
                
                building.addEventListener('mouseleave', () => {
                    const tooltip = document.getElementById('tooltip');
                    tooltip.style.opacity = '0';
                });
            });
        }

        // Timer System
        function startTimer() {
            // Stop any existing timer
            stopTimer();
            
            // Reset timer to 60 seconds
            gameState.timerSeconds = 60;
            gameState.isTimerRunning = true;
            
            // Show timer container
            const timerContainer = document.getElementById('timer-container');
            timerContainer.classList.add('active');
            
            // Update display
            updateTimerDisplay();
            
            // Start countdown interval
            gameState.timerInterval = setInterval(() => {
                gameState.timerSeconds--;
                updateTimerDisplay();
                
                if (gameState.timerSeconds <= 0) {
                    handleTimeout();
                }
            }, 1000);
        }

        function stopTimer() {
            gameState.isTimerRunning = false;
            
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
                gameState.timerInterval = null;
            }
            
            // Hide timer container
            const timerContainer = document.getElementById('timer-container');
            timerContainer.classList.remove('active');
        }

        function pauseTimer() {
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
                gameState.timerInterval = null;
            }
            gameState.isTimerRunning = false;
        }

        function resumeTimer() {
            if (!gameState.isTimerRunning && gameState.timerSeconds > 0) {
                gameState.isTimerRunning = true;
                
                gameState.timerInterval = setInterval(() => {
                    gameState.timerSeconds--;
                    updateTimerDisplay();
                    
                    if (gameState.timerSeconds <= 0) {
                        handleTimeout();
                    }
                }, 1000);
            }
        }

        function updateTimerDisplay() {
            const secondsElement = document.getElementById('timer-seconds');
            const barFill = document.getElementById('timer-bar-fill');
            
            // Update seconds text
            secondsElement.textContent = gameState.timerSeconds;
            
            // Calculate percentage for progress bar
            const percentage = (gameState.timerSeconds / 60) * 100;
            barFill.style.width = percentage + '%';
            
            // Update bar color based on time remaining
            barFill.classList.remove('warning', 'danger');
            if (gameState.timerSeconds <= 10) {
                barFill.classList.add('danger');
            } else if (gameState.timerSeconds <= 30) {
                barFill.classList.add('warning');
            }
        }

        function handleTimeout() {
            stopTimer();
            
            // Get current scene and randomly select a choice
            const currentSceneKey = getCurrentSceneKey();
            if (currentSceneKey && gameData[currentSceneKey]) {
                const scene = gameData[currentSceneKey];
                if (scene.choices && scene.choices.length > 0) {
                    const randomIndex = Math.floor(Math.random() * scene.choices.length);
                    makeChoice(currentSceneKey, randomIndex);
                }
            }
        }

        // Helper function to track current scene
        let currentSceneKey = null;

        function getCurrentSceneKey() {
            return currentSceneKey;
        }

        function setCurrentSceneKey(key) {
            currentSceneKey = key;
        }

        // Game Data (condensed for brevity - same structure as before)
        const gameData = {
            intro: {
                title: "Welcome to Tiger Central",
                story: `<p>Congratulations! You've just won the election to become the mayor of Tiger Central, a city with a population of 300,000.</p><p>The previous mayor was corrupt‚Äîembezzling money, stealing from residents, and ultimately disappearing without a trace, leaving Tiger Central in shambles.</p><p>The city needs strong leadership to rebuild. Every decision you make will have consequences that affect different groups of people. There are no perfect solutions‚Äîonly choices and their outcomes.</p><p>Can you restore Tiger Central to its former glory while keeping everyone happy?</p>`,
                choices: [{ text: "üéÆ Start Your Mayoral Journey", icon: "üöÄ", next: 'choice1' }]
            },
            choice1: {
                chapter: "Chapter 1: Economic Opportunity",
                title: "A Factory Proposal",
                story: `<p>A large manufacturing company, TigerTech Industries, has approached the city with an interesting proposition.</p><p>They want to build a factory in Tiger Central, promising to bring 500 jobs to the community and offering $10 million to the city as an incentive.</p><p>However, factories can bring pollution, traffic, and other concerns. What do you decide?</p>`,
                choices: [
                    { text: "Accept the factory deal", icon: "‚úÖ", effects: { happiness: 10, cityFunds: 20, specialInterest: 15, personalProfit: 5 }, next: 'choice2A', consequence: "TigerTech Industries is excited to begin construction. Citizens are hopeful about new job opportunities.", building: 'factory' },
                    { text: "Reject the factory", icon: "‚ùå", effects: { happiness: -10, cityFunds: -10, specialInterest: -15, personalProfit: 0 }, next: 'choice2B', consequence: "TigerTech Industries is disappointed. Unemployment remains high, and residents are worried about job prospects." }
                ]
            },
            choice2A: {
                chapter: "Chapter 1: Location Matters",
                title: "Where to Build?",
                story: `<p>Now that you've approved the factory, you need to decide where to place it.</p><p>The company has given you two options:</p><ul><li><strong>Near the River:</strong> Easy access to water for manufacturing, but potential pollution risks</li><li><strong>Near Suburban Neighborhoods:</strong> Closer to workers' homes, but will increase noise/traffic</li></ul>`,
                choices: [
                    { text: "Build near the river", icon: "üèûÔ∏è", effects: { happiness: -5, cityFunds: 5, specialInterest: 10, personalProfit: 3 }, next: 'choice3A1', consequence: "Construction begins by the river. Environmental groups are concerned about water quality." },
                    { text: "Build near suburban area", icon: "üèòÔ∏è", effects: { happiness: -15, cityFunds: -5, specialInterest: 5, personalProfit: 2 }, next: 'choice3A2', consequence: "Families are displaced to make room for the factory. Homeowners are upset.", building: 'house' }
                ]
            },
            choice2B: {
                chapter: "Chapter 1: Unemployment Crisis",
                title: "Addressing Joblessness",
                story: `<p>Without the factory, unemployment remains high in Tiger Central. People are struggling to make ends meet.</p><p>You need to find a way to help unemployed citizens. What's your approach?</p>`,
                choices: [
                    { text: "Raise taxes for unemployment benefits", icon: "üí∞", effects: { happiness: -15, cityFunds: 10, specialInterest: -5, personalProfit: 0 }, next: 'choice3B1', consequence: "Unemployment benefits help struggling families, but working citizens feel the tax burden." },
                    { text: "Hire people for infrastructure projects", icon: "üõ†Ô∏è", effects: { happiness: 10, cityFunds: -15, specialInterest: 5, personalProfit: 0 }, next: 'choice3B2', consequence: "New infrastructure jobs are created. Roads and bridges are being renovated.", building: 'office' }
                ]
            },
            choice3A1: {
                chapter: "Chapter 1: Pollution Problems",
                title: "Water Contamination",
                story: `<p>The factory near the river is now operational, but there's a serious problem.</p><p>Chemical waste from manufacturing is contaminating the water supply. The city needs expensive water treatment to keep it safe.</p><p>Who should pay for this?</p>`,
                choices: [
                    { text: "Tax TigerTech Industries", icon: "üè≠", effects: { happiness: 15, cityFunds: 10, specialInterest: -10, personalProfit: 0 }, next: 'choice4A11', consequence: "Citizens appreciate you holding the company accountable." },
                    { text: "Raise water bills for citizens", icon: "üíß", effects: { happiness: -20, cityFunds: 15, specialInterest: 10, personalProfit: 5 }, next: 'choice4A12', consequence: "Citizens are outraged that they're paying for corporate pollution." }
                ]
            },
            choice3A2: {
                chapter: "Chapter 1: Suburban Unrest",
                title: "Angry Neighbors",
                story: `<p>The factory near the suburban area has caused major problems for residents.</p><p>Noise, traffic, and pollution have increased dramatically. Property values are dropping, and residents are demanding action.</p>`,
                choices: [
                    { text: "Offer compensation to residents", icon: "üíµ", effects: { happiness: 5, cityFunds: -15, specialInterest: -5, personalProfit: 0 }, next: 'choice4A21', consequence: "Residents receive financial compensation. The city budget is stretched thin." },
                    { text: "Build new homes and relocate", icon: "üè†", effects: { happiness: 10, cityFunds: -20, specialInterest: 0, personalProfit: 0 }, next: 'choice4A22', consequence: "New homes are being constructed. Relocation plans are underway.", building: 'house' },
                    { text: "Ignore their complaints", icon: "üôâ", effects: { happiness: -25, cityFunds: 5, specialInterest: 15, personalProfit: 10 }, next: 'choice4A23', consequence: "Residents feel abandoned. Trust in your leadership is declining rapidly." }
                ]
            },
            choice3B1: {
                chapter: "Chapter 1: Social Division",
                title: "Rising Tensions",
                story: `<p>The unemployment tax has created serious social tensions in Tiger Central.</p><p>Employed and unemployed citizens are clashing. Crime is increasing, and neighborhood disputes are common.</p>`,
                choices: [
                    { text: "Increase surveillance", icon: "üìπ", effects: { happiness: -10, cityFunds: -10, specialInterest: 10, personalProfit: 0 }, next: 'choice4B11', consequence: "More cameras and police patrol the streets. Crime drops, but citizens feel watched." },
                    { text: "Fund job-training programs", icon: "üìö", effects: { happiness: 15, cityFunds: -15, specialInterest: -5, personalProfit: 0 }, next: 'choice4B12', consequence: "Training programs begin. Unemployed citizens are learning new skills.", building: 'office' }
                ]
            },
            choice3B2: {
                chapter: "Chapter 1: Safety Concerns",
                title: "Workplace Accidents",
                story: `<p>The infrastructure projects have created jobs, but workplace accidents and injuries are increasing dramatically.</p><p>What's your response?</p>`,
                choices: [
                    { text: "Increase safety regulations", icon: "‚ö†Ô∏è", effects: { happiness: 10, cityFunds: -10, specialInterest: -5, personalProfit: 0 }, next: 'choice4B21', consequence: "New safety rules are implemented. Workers feel safer, but projects are slowing down." },
                    { text: "Ignore safety concerns", icon: "‚è©", effects: { happiness: -20, cityFunds: 10, specialInterest: 10, personalProfit: 5 }, next: 'choice4B22', consequence: "Projects move forward quickly, but injuries continue to mount." }
                ]
            },
            choice4A11: {
                chapter: "Chapter 1: Corporate Backlash",
                title: "Labor Dispute",
                story: `<p>TigerTech Industries is retaliating against the pollution taxes you imposed.</p><p>They're threatening to cut wages and hours for their 500 employees. Do you intervene?</p>`,
                choices: [
                    { text: "Implement labor protection laws", icon: "‚öñÔ∏è", effects: { happiness: 15, cityFunds: 0, specialInterest: -15, personalProfit: 0 }, next: 'ending', consequence: "Workers are protected, but TigerTech considers leaving Tiger Central." },
                    { text: "Let the company cut wages", icon: "üìâ", effects: { happiness: -15, cityFunds: 0, specialInterest: 10, personalProfit: 3 }, next: 'ending', consequence: "Workers face pay cuts. Families struggle." }
                ]
            },
            choice4A12: {
                chapter: "Chapter 1: Public Protest",
                title: "Citizens Revolt",
                story: `<p>Protests have erupted throughout Tiger Central!</p><p>Citizens are furious that they're paying for water treatment while the polluting company faces no consequences.</p>`,
                choices: [
                    { text: "Meet with protest leaders", icon: "ü§ù", effects: { happiness: 10, cityFunds: -5, specialInterest: -10, personalProfit: 0 }, next: 'ending', consequence: "You listen to citizens' concerns and promise reform. Trust begins to rebuild." },
                    { text: "Send in police", icon: "üöî", effects: { happiness: -25, cityFunds: -5, specialInterest: 5, personalProfit: 0 }, next: 'ending', consequence: "Protests are dispersed by force. Resentment grows." }
                ]
            },
            choice4A21: {
                chapter: "Chapter 1: Budget Crisis",
                title: "Financial Strain",
                story: `<p>Compensating residents has created a budget shortfall. You need to balance the budget somehow.</p>`,
                choices: [
                    { text: "Raise local taxes", icon: "üìä", effects: { happiness: -15, cityFunds: 15, specialInterest: -5, personalProfit: 0 }, next: 'ending', consequence: "Tax increases anger citizens, but the budget is stabilized." },
                    { text: "Cut education and parks funding", icon: "‚úÇÔ∏è", effects: { happiness: -20, cityFunds: 15, specialInterest: 5, personalProfit: 0 }, next: 'ending', consequence: "Schools and parks suffer. Families with children are upset." }
                ]
            },
            choice4A22: {
                chapter: "Chapter 1: Construction Delays",
                title: "Housing Crisis",
                story: `<p>The new homes for relocated residents are behind schedule. The contractor is having trouble finding materials and costs are rising.</p>`,
                choices: [
                    { text: "Rush with cheaper materials", icon: "‚è∞", effects: { happiness: -10, cityFunds: 5, specialInterest: 5, personalProfit: 3 }, next: 'ending', consequence: "Homes are completed quickly but quality is poor." },
                    { text: "Spend extra for quality", icon: "üíé", effects: { happiness: 15, cityFunds: -20, specialInterest: -5, personalProfit: 0 }, next: 'ending', consequence: "Beautiful, safe homes are built. The budget takes a hit.", building: 'house' }
                ]
            },
            choice4A23: {
                chapter: "Chapter 1: Corporate Overreach",
                title: "Illegal Expansion",
                story: `<p>TigerTech has taken advantage of your inaction! They've been illegally expanding their operations onto protected land.</p>`,
                choices: [
                    { text: "Continue ignoring it", icon: "üôà", effects: { happiness: -30, cityFunds: 0, specialInterest: 20, personalProfit: 15 }, next: 'ending', consequence: "Your inaction becomes a scandal. Citizens have lost all faith." },
                    { text: "Fine the company", icon: "‚ö°", effects: { happiness: 20, cityFunds: 10, specialInterest: -20, personalProfit: 0 }, next: 'ending', consequence: "You finally take a stand. Citizens applaud!", building: 'park' }
                ]
            },
            choice4B11: {
                chapter: "Chapter 1: Surveillance State",
                title: "Privacy Concerns",
                story: `<p>Crime has dropped thanks to increased surveillance, but citizens are uneasy. People feel like they're always being watched.</p>`,
                choices: [
                    { text: "Scale back surveillance", icon: "üîô", effects: { happiness: 10, cityFunds: 5, specialInterest: -10, personalProfit: 0 }, next: 'ending', consequence: "Citizens breathe easier with less monitoring." },
                    { text: "Double down", icon: "üîí", effects: { happiness: -20, cityFunds: -10, specialInterest: 15, personalProfit: 0 }, next: 'ending', consequence: "Tiger Central becomes a surveillance state." }
                ]
            },
            choice4B12: {
                chapter: "Chapter 1: Employment Challenge",
                title: "Hiring Hesitation",
                story: `<p>The job-training programs are producing qualified workers, but local businesses are hesitant to hire trainees.</p>`,
                choices: [
                    { text: "Place hiring quotas", icon: "üìã", effects: { happiness: 5, cityFunds: 0, specialInterest: -15, personalProfit: 0 }, next: 'ending', consequence: "Businesses must hire trainees. Some comply grudgingly." },
                    { text: "Offer tax breaks", icon: "üí∏", effects: { happiness: 10, cityFunds: -10, specialInterest: 10, personalProfit: 0 }, next: 'ending', consequence: "Tax incentives work! Employment rises.", building: 'shop' }
                ]
            },
            choice4B21: {
                chapter: "Chapter 1: Productivity Crisis",
                title: "Slowing Progress",
                story: `<p>The new safety regulations are protecting workers, but productivity has dropped. Projects are behind schedule.</p>`,
                choices: [
                    { text: "Fire underperforming employees", icon: "‚ùå", effects: { happiness: -15, cityFunds: 5, specialInterest: 10, personalProfit: 0 }, next: 'ending', consequence: "Projects speed up, but workers live in fear." },
                    { text: "Extend deadlines", icon: "‚è±Ô∏è", effects: { happiness: 10, cityFunds: -5, specialInterest: -10, personalProfit: 0 }, next: 'ending', consequence: "Quality and safety improve. Citizens appreciate patience." }
                ]
            },
            choice4B22: {
                chapter: "Chapter 1: Legal Trouble",
                title: "Lawsuits Mounting",
                story: `<p>Injury reports are piling up, and now the lawsuits are coming. Injured workers are demanding compensation.</p>`,
                choices: [
                    { text: "Pay employees to keep quiet", icon: "üí∞", effects: { happiness: -20, cityFunds: -15, specialInterest: 10, personalProfit: -5 }, next: 'ending', consequence: "Hush money works temporarily, but rumors spread." },
                    { text: "Let them bring cases to court", icon: "‚öñÔ∏è", effects: { happiness: 5, cityFunds: -20, specialInterest: -15, personalProfit: 0 }, next: 'ending', consequence: "The truth comes out. You take responsibility and promise reform." }
                ]
            },
            ending: { title: "Your Term Ends", story: `<p>Your first year as mayor of Tiger Central has come to an end. Let's see how you did...</p>` }
        };

        // Update stats display with animations
        function updateStats() {
            gameState.happiness = Math.max(0, Math.min(100, gameState.happiness));
            gameState.cityFunds = Math.max(0, Math.min(100, gameState.cityFunds));
            gameState.specialInterest = Math.max(0, Math.min(100, gameState.specialInterest));

            document.getElementById('happiness-value').textContent = gameState.happiness;
            document.getElementById('happiness-bar').style.width = gameState.happiness + '%';

            document.getElementById('funds-value').textContent = '$' + gameState.cityFunds + 'M';
            document.getElementById('funds-bar').style.width = gameState.cityFunds + '%';

            document.getElementById('interest-value').textContent = gameState.specialInterest;
            document.getElementById('interest-bar').style.width = gameState.specialInterest + '%';

            document.getElementById('profit-value').textContent = '$' + gameState.personalProfit + 'M';
        }

        // Apply choice effects
        function applyEffects(effects) {
            if (effects.happiness) gameState.happiness += effects.happiness;
            if (effects.cityFunds) gameState.cityFunds += effects.cityFunds;
            if (effects.specialInterest) gameState.specialInterest += effects.specialInterest;
            if (effects.personalProfit) gameState.personalProfit += effects.personalProfit;
            
            updateStats();
        }

        // Render scene
        function renderScene(sceneKey) {
            const scene = gameData[sceneKey];
            const content = document.getElementById('game-content');
            
            // Stop timer when transitioning scenes
            stopTimer();
            
            // Track current scene for timer
            setCurrentSceneKey(sceneKey);
            
            if (sceneKey === 'ending') {
                renderEnding();
                return;
            }

            let html = '';

            if (scene.chapter) {
                html += `<div class="chapter-title">${scene.chapter}</div>`;
            }

            html += `<div class="story-section"><h2>${scene.title}</h2><div class="story-text">${scene.story}</div></div>`;

            if (sceneKey === 'intro') {
                html += `<div class="intro-screen"><button class="start-btn" onclick="startGame()"><span class="start-btn-text">Let's Begin!</span></button></div>`;
            } else {
                html += `<div class="choices">`;
                scene.choices.forEach((choice, index) => {
                    html += `<div class="choice-card" onclick="makeChoice('${sceneKey}', ${index})">`;
                    html += `<span class="choice-icon">${choice.icon}</span>`;
                    html += `<div class="choice-text">${choice.text}</div>`;
                    html += `</div>`;
                });
                html += `</div>`;
                
                // Start timer for choice scenes (not intro or ending)
                setTimeout(() => {
                    startTimer();
                }, 100);
            }

            content.innerHTML = html;
        }

        // Make a choice
        function makeChoice(sceneKey, choiceIndex) {
            // Stop the timer when choice is made
            stopTimer();
            
            const scene = gameData[sceneKey];
            const choice = scene.choices[choiceIndex];

            gameState.decisions.push({ scene: sceneKey, choice: choice.text });

            // Add building if specified
            if (choice.building) {
                addBuilding(choice.building);
            }

            if (choice.effects) {
                applyEffects(choice.effects);
                
                if (choice.consequence) {
                    showConsequence(choice.effects, choice.consequence);
                }
            }

            setTimeout(() => {
                renderScene(choice.next);
            }, 2500);
        }

        // Show consequence
        function showConsequence(effects, message) {
            const content = document.getElementById('game-content');
            const consequenceDiv = document.createElement('div');
            consequenceDiv.className = 'consequences';
            
            let html = '<h3>‚ö° Consequences</h3>';
            html += `<p>${message}</p>`;
            
            if (effects.happiness) {
                html += `<div class="consequence-item ${effects.happiness > 0 ? 'positive' : 'negative'}">`;
                html += `üòä Happiness: ${effects.happiness > 0 ? '+' : ''}${effects.happiness}`;
                html += `</div>`;
            }
            
            if (effects.cityFunds) {
                html += `<div class="consequence-item ${effects.cityFunds > 0 ? 'positive' : 'negative'}">`;
                html += `üí∞ City Funds: ${effects.cityFunds > 0 ? '+' : ''}${effects.cityFunds}M`;
                html += `</div>`;
            }
            
            if (effects.specialInterest) {
                html += `<div class="consequence-item ${effects.specialInterest > 0 ? 'positive' : 'negative'}">`;
                html += `üèõÔ∏è Special Interest: ${effects.specialInterest > 0 ? '+' : ''}${effects.specialInterest}`;
                html += `</div>`;
            }
            
            if (effects.personalProfit !== 0) {
                html += `<div class="consequence-item ${effects.personalProfit > 0 ? 'positive' : 'negative'}">`;
                html += `üíµ Your Profit: ${effects.personalProfit > 0 ? '+' : ''}${effects.personalProfit}M`;
                html += `</div>`;
            }

            consequenceDiv.innerHTML = html;
            content.appendChild(consequenceDiv);
            consequenceDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Render ending
        function renderEnding() {
            const content = document.getElementById('game-content');
            
            let rating = '';
            let message = '';
            let avgScore = (gameState.happiness + gameState.cityFunds + gameState.specialInterest) / 3;

            if (avgScore >= 70) {
                rating = 'üåü Excellent Mayor!';
                message = 'You balanced competing interests masterfully! Tiger Central is thriving under your leadership.';
                addBuilding('park');
                addBuilding('park');
            } else if (avgScore >= 50) {
                rating = 'üëç Decent Mayor';
                message = "You made tough choices and kept the city running. Some groups are happier than others, but that's politics!";
                addBuilding('shop');
            } else if (avgScore >= 30) {
                rating = 'üò¨ Struggling Mayor';
                message = 'Your term was rocky. Many citizens are unhappy with your decisions.';
            } else {
                rating = '‚ùå Failed Mayor';
                message = 'Your decisions have left Tiger Central worse than before. The city is considering a recall election.';
            }

            let profitMessage = '';
            if (gameState.personalProfit > 15) {
                profitMessage = '<p style="color:#d63031;font-size:1.2em;">‚ö†Ô∏è Your personal profit-taking has not gone unnoticed. Citizens question your integrity.</p>';
            } else if (gameState.personalProfit > 5) {
                profitMessage = '<p style="font-size:1.1em;">You made some personal profit along the way. Not illegal, but not exactly selfless leadership either.</p>';
            } else if (gameState.personalProfit <= 0) {
                profitMessage = '<p style="color:#00b894;font-size:1.2em;">‚ú® You remained ethical and avoided personal enrichment. Citizens respect your integrity!</p>';
            }

            const html = `
                <div class="game-over">
                    <h2>${rating}</h2>
                    <p style="font-size:1.3em;margin:20px 0;font-weight:600;">${message}</p>
                    ${profitMessage}
                    
                    <div class="final-stats">
                        <h3>üìä Final Statistics</h3>
                        <div class="final-stat-item"><strong>Population Happiness:</strong> ${gameState.happiness}/100 ${gameState.happiness >= 70 ? 'üéâ' : gameState.happiness >= 40 ? 'üòê' : 'üòû'}</div>
                        <div class="final-stat-item"><strong>City Funds:</strong> $${gameState.cityFunds}M ${gameState.cityFunds >= 70 ? 'üí∞' : gameState.cityFunds >= 40 ? 'üíµ' : 'üí∏'}</div>
                        <div class="final-stat-item"><strong>Special Interest Support:</strong> ${gameState.specialInterest}/100 ${gameState.specialInterest >= 70 ? 'ü§ù' : gameState.specialInterest >= 40 ? 'üëå' : 'üëé'}</div>
                        <div class="final-stat-item"><strong>Your Personal Profit:</strong> $${gameState.personalProfit}M ${gameState.personalProfit > 10 ? '‚ö†Ô∏è' : gameState.personalProfit > 0 ? 'üíµ' : '‚ú®'}</div>
                        <div class="final-stat-item"><strong>Buildings Added:</strong> ${gameState.buildings.length} structures üèóÔ∏è</div>
                    </div>

                    <div class="story-section" style="margin-top:20px;text-align:left;">
                        <h3>üéì What You Learned</h3>
                        <p>Politics isn't black and white. Every decision has trade-offs:</p>
                        <ul style="margin-left:20px;margin-top:10px;line-height:1.8;">
                            <li>Economic growth can come at an environmental cost</li>
                            <li>Helping one group might upset another</li>
                            <li>Sometimes there are no perfect solutions</li>
                            <li>Leadership requires balancing many competing interests</li>
                            <li>Corruption and personal profit-taking erode public trust</li>
                        </ul>
                        <p style="margin-top:15px;">Real mayors face these kinds of complex decisions every day. Understanding that politics involves difficult choices and trade-offs helps us be better informed citizens!</p>
                    </div>

                    <button class="start-btn" onclick="location.reload()" style="margin-top:30px;"><span class="start-btn-text">üîÑ Play Again</span></button>
                </div>
            `;

            content.innerHTML = html;
        }

        // Start game
        function startGame() {
            renderScene('choice1');
        }

        // Initialize
        createParticles();
        renderBuildings();
        renderScene('intro');
    </script>
</body>
</html>